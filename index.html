<<<<<<< HEAD
<!doctype html>
<meta charset="utf-8">
<title>ã‚·ãƒ¼ãƒˆèª­ã¿å–ã‚Šãƒ“ãƒ¥ãƒ¼ã‚¢</title>
<style>
  body{font-family:system-ui, sans-serif; margin:24px; line-height:1.6}
  .row{display:flex; gap:8px; flex-wrap:wrap; align-items:center}
  input,button{padding:8px 10px; font-size:14px}
  table{border-collapse:collapse; width:100%; margin-top:14px}
  th,td{border:1px solid #ddd; padding:8px; font-size:14px}
  th{background:#f5f7fa; text-align:left}
  pre{white-space:pre-wrap; background:#f8fafc; border:1px solid #eee; padding:10px}

  /* è¿½åŠ : æœ¬æ–‡ãªã©ã®æ”¹è¡Œã‚’ãã®ã¾ã¾è¡¨ç¤ºï¼†é•·æ–‡ã§ã‚‚æŠ˜ã‚Šè¿”ã— */
  td{ white-space: pre-line; vertical-align: top; overflow-wrap: anywhere; }
</style>

<h1>ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆèª­ã¿å–ã‚Š</h1>

<div class="row">
  <label>APP_URL:https://script.google.com/macros/s/AKfycbxCrFgnc0WXv7SwXUZM7F2MMU1wVVjQgjdRbB6EUI4xk9ffzlPwwur_eyd0cPnKpRfn/exec
    <!-- /dev ã§ã¯ãªã /exec ã‚’æ¨å¥¨ -->
    <input id="app" size="60" placeholder="https://script.google.com/macros/s/AKfycbxCrFgnc0WXv7SwXUZM7F2MMU1wVVjQgjdRbB6EUI4xk9ffzlPwwur_eyd0cPnKpRfn/exec">
  </label>
  <label>ã‚·ãƒ¼ãƒˆï¼ˆã‚¿ãƒ–ï¼‰:
    <input id="sheet" placeholder="ä¾‹ï¼šã‚·ãƒ¼ãƒˆ1ï¼ˆURLã‚‚OKï¼‰">
  </label>
  <label>ç¯„å›²:
    <input id="range" value="A1:Z999">
  </label>
  <button id="load">å–å¾—</button>
</div>

<div id="status" style="margin-top:10px; color:#667085"></div>
<div id="error" style="color:#b00020; margin-top:6px"></div>
<div id="table"></div>
<details style="margin-top:10px">
  <summary>ç”ŸJSON</summary>
  <pre id="raw">-</pre>
</details>

<script>
document.getElementById('load').addEventListener('click', load);

async function load(){
  const app   = document.getElementById('app').value.trim();
  const sheet = document.getElementById('sheet').value.trim();
  const range = document.getElementById('range').value.trim();
  const status = document.getElementById('status');
  const error  = document.getElementById('error');
  const table  = document.getElementById('table');
  const raw    = document.getElementById('raw');

  error.textContent = '';
  table.innerHTML = '';
  raw.textContent = '-';

  if(!app){
    error.textContent = 'APP_URLï¼ˆ/execï¼‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„';
    return;
  }
  if(/\/dev\/?$/.test(app)){
    status.textContent = 'æ³¨æ„: /dev ã¯ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§å¤±æ•—ã—ãŒã¡ã§ã™ã€‚/exec ã‚’ä½¿ã£ã¦ãã ã•ã„ã€‚';
  }

  let url;
  try{
    url = new URL(app);
  }catch{
    error.textContent = 'APP_URL ãŒä¸æ­£ã§ã™ï¼ˆhttps://â€¦/exec ã‚’æŒ‡å®šï¼‰';
    return;
  }
  url.searchParams.set('range', range || 'A1:Z999');

  // ã€Œã‚·ãƒ¼ãƒˆã€å…¥åŠ›ãŒ URL or gid or åå‰ã®ã„ãšã‚Œã§ã‚‚OKã«ã™ã‚‹
  if (sheet) {
    const urlLike = /^https?:\/\//.test(sheet);
    const gidMatch = sheet.match(/[?&]gid=(\d+)/);
    if (gidMatch) {
      url.searchParams.set('gid', gidMatch[1]); // URLä¸­ã®gidã‚’æ¡ç”¨
    } else if (!urlLike && /^\d+$/.test(sheet)) {
      url.searchParams.set('gid', sheet);       // æ•°å­—ã ã‘ãªã‚‰gid
    } else if (!urlLike) {
      url.searchParams.set('sheet', sheet);     // ãã‚Œä»¥å¤–ã¯ã‚¿ãƒ–å
    } else {
      status.textContent = 'URLã« gid ãŒç„¡ã„å ´åˆã¯ã€ã‚¿ãƒ–åã‚’æŒ‡å®šã—ã¦ãã ã•ã„ã€‚';
    }
  }

  status.textContent = 'èª­ã¿è¾¼ã¿ä¸­â€¦';

  try{
    const json = await fetchJson(url.toString());
    render(json);
  }catch(e1){
    try{ const json = await jsonpFetch(url); render(json); }
    catch(e2){ status.textContent = ''; error.textContent = 'ã‚¨ãƒ©ãƒ¼: ' + (e2.message || e2 || e1.message || e1); }
  }

  function render(json){
    raw.textContent = JSON.stringify(json, null, 2);
    if(json.error){ throw new Error(json.error); }

    const items = Array.isArray(json.items) ? json.items : [];
    status.textContent = `å–å¾—: ${json.count ?? items.length} è¡Œï¼ˆsheet=${json.sheet ?? '-'} / range=${json.range ?? '-' }ï¼‰`;

    if(items.length === 0){
      table.innerHTML = '<p>ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚</p>';
      return;
    }

    const headers = Object.keys(items[0]);
    const thead = '<thead><tr>' + headers.map(h=>`<th>${escapeHtml(h)}</th>`).join('') + '</tr></thead>';
    const rows  = items.map(obj => '<tr>' + headers.map(h => `<td>${escapeHtml(obj[h] ?? '')}</td>`).join('') + '</tr>').join('');
    table.innerHTML = `<table>${thead}<tbody>${rows}</tbody></table>`;
  }
}

async function fetchJson(u){
  const res = await fetch(u, { cache:'no-store', mode:'cors', credentials:'omit' });
  const ct  = (res.headers.get('content-type')||'').toLowerCase();
  const text = await res.text();
  if(!res.ok) throw new Error(res.status + ' ' + res.statusText + ' / ' + text.slice(0,200));
  if(!ct.includes('application/json')) throw new Error('JSONä»¥å¤–ã®å¿œç­”: ' + ct + ' / ' + text.slice(0,120));
  return JSON.parse(text);
}

function jsonpFetch(urlObj){
  return new Promise((resolve, reject) => {
    const cb = '__jsonp_cb_' + Date.now() + '_' + Math.floor(Math.random()*1e6);
    urlObj.searchParams.set('callback', cb);
    const timer = setTimeout(() => { cleanup(); reject(new Error('JSONPã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ')); }, 15000);
    function cleanup(){ clearTimeout(timer); delete window[cb]; if (script && script.parentNode) script.parentNode.removeChild(script); }
    window[cb] = data => { cleanup(); resolve(data); };
    const script = document.createElement('script');
    script.src = urlObj.toString();
    script.onerror = () => { cleanup(); reject(new Error('JSONPèª­è¾¼å¤±æ•—')); };
    document.head.appendChild(script);
  });
}

function escapeHtml(s){
  return String(s).replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
}
</script>
=======
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ChatGPT è³ªå•ãƒ†ãƒ³ãƒ—ãƒ¬é›†</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f9f9f9;
      margin: 0;
      padding: 20px;
    }
    h1 {
      text-align: center;
      margin-bottom: 20px;
    }
    details {
      background: #fff;
      border: 1px solid #ddd;
      border-radius: 6px;
      margin: 10px 0;
      padding: 10px;
    }
    summary {
      font-weight: bold;
      cursor: pointer;
      padding: 5px;
      outline: none;
    }
    .template {
      margin: 10px 0;
      padding: 10px;
      border-left: 3px solid #2196F3;
      background: #f1f8ff;
    }
    .title {
      font-weight: bold;
      margin-bottom: 5px;
    }
    .copy-btn {
      margin-top: 5px;
      padding: 4px 8px;
      font-size: 12px;
      border: none;
      background: #2196F3;
      color: white;
      border-radius: 4px;
      cursor: pointer;
    }
    .copy-btn:hover {
      background: #1976d2;
    }
  </style>
</head>
<body>
  <h1>ğŸ’¡ ChatGPT è³ªå•ãƒ†ãƒ³ãƒ—ãƒ¬é›†</h1>
  <div id="container"></div>

  <script>
    // templates.json ã‚’èª­ã¿è¾¼ã‚€
    fetch("templates.json")
      .then(res => res.json())
      .then(data => {
        const grouped = {};
        // ã‚«ãƒ†ã‚´ãƒªã”ã¨ã«ã¾ã¨ã‚ã‚‹
        data.forEach(t => {
          if (!grouped[t.category]) grouped[t.category] = [];
          grouped[t.category].push(t);
        });

        const container = document.getElementById("container");
        for (const cat in grouped) {
          const details = document.createElement("details");
          const summary = document.createElement("summary");
          summary.textContent = cat;
          details.appendChild(summary);

          grouped[cat].forEach(t => {
            const div = document.createElement("div");
            div.className = "template";

            const title = document.createElement("div");
            title.className = "title";
            title.textContent = t.title;

            const body = document.createElement("pre");
            body.textContent = t.body;

            const btn = document.createElement("button");
            btn.className = "copy-btn";
            btn.textContent = "ã‚³ãƒ”ãƒ¼";
            btn.onclick = () => {
              navigator.clipboard.writeText(t.body);
              btn.textContent = "âœ… ã‚³ãƒ”ãƒ¼æ¸ˆã¿";
              setTimeout(() => btn.textContent = "ã‚³ãƒ”ãƒ¼", 1500);
            };

            div.appendChild(title);
            div.appendChild(body);
            div.appendChild(btn);
            details.appendChild(div);
          });

          container.appendChild(details);
        }
      });
  </script>
</body>
</html>
>>>>>>> 8f3af2d6cd0a11a0e0e8453367def26a4f489d6f
